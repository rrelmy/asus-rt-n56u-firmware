<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta HTTP-EQUIV="Pragma" CONTENT="no-cache">
<meta HTTP-EQUIV="Expires" CONTENT="-1">
<link rel="shortcut icon" href="images/favicon.png">
<link rel="icon" href="images/favicon.png">
<link rel="stylesheet" type="text/css" href="../form_style.css">
<link rel="stylesheet" type="text/css" href="qis_style.css">

<script type="text/JavaScript" src="/state.js"></script>
<script>
var flag = '<% get_parameter("flag"); %>';
var reIP = '<% nvram_get_x("LANHostConfig","lan_ipaddr_t"); %>';

if(parent.get_failed_connection_reason().length > 0){
	flag = parent.get_failed_connection_reason();
}
var wps_config_state = '<% nvram_get_x("WLANConfig11b", "wps_config_state"); %>';
var orig_x_Setting = '<% nvram_get_x("General",  "x_Setting"); %>';

var Sys = {};
var ua = navigator.userAgent.toLowerCase();
if (window.ActiveXObject)
	Sys.ie = ua.match(/msie ([\d.]+)/)[1]
else if (document.getBoxObjectFor)
	Sys.firefox = ua.match(/firefox\/([\d.]+)/)[1]
/*else if (window.MessageEvent && !document.getBoxObjectFor)
	Sys.chrome = ua.match(/chrome\/([\d.]+)/)[1]*/
else if (window.opera)
	Sys.opera = ua.match(/opera.([\d.]+)/)[1]
else if (window.openDatabase)
	Sys.safari = ua.match(/version\/([\d.]+)/)[1];

function QKfinish_load_body(){
	parent.document.title = "ASUS Wireless Router <#Web_Title#>";
	hideLinkTag();

	/*if(wps_config_state != 1)
		$("no_security_hint").style.display = "block";
	else
		$("no_security_hint").style.display = "none";*/

	if(orig_x_Setting != "1")
		set_x_Setting("1", "/qis/QIS_internet_success.htm");
	
	if(Sys.firefox){
		$("closeButton").style.display="none";
	}	
	
	if(this.flag.length > 0){
		
		$("fail_to_connect").style.display = "";
		$("succeed_to_connect").style.display = "none";
		$("check_isp").style.display = "none";
		
		show_fail_response();
		
		showtext($("title_item"), "<#QKSet_Internet_Setup_fail#>");
	}
	else{		
		$("fail_to_connect").style.display = "none";
		$("succeed_to_connect").style.display = "";
		$("li_of_wireless").style.display = "";
		$("check_isp").style.display = "";
		//$("succeed_to_connect").style.display = (Sys.safari)?"":"block";
		
		showtext($("title_item"), "<#QKSet_finish_desc#>");
	}
}

function show_fail_response(){
	if(this.flag.indexOf("dhcp_wrong_") >= 0){
		$("link_id").onclick = function(){
				gotoDetect();
			};
		showtext($("link_str"), "<#QKSet_Internet_Setup_fail_method1#>");
		showtext($("link_reason"), "<#QKSet_Internet_Setup_fail_reason1#>");
	}
	else if(this.flag.indexOf("pppoe_wrong_") >= 0){
		if(this.flag == "pppoe_wrong_input"){
			$("link_id").onclick = function(){
					gotoPPPoE();
				};
			showtext($("link_str"), "<#QKSet_Internet_Setup_fail_method2#>");
			showtext($("link_reason"), "<#QKSet_Internet_Setup_fail_reason2#>");
		}
		else{
			$("link_id").onclick = function(){
					gotoDetect();
				};
			showtext($("link_str"), "<#QKSet_Internet_Setup_fail_method1#>");
			showtext($("link_reason"), "<#QKSet_Internet_Setup_fail_reason3#>");
		}
	}
	else if(this.flag.indexOf("pptp_wrong_") >= 0){
		$("link_id").onclick = function(){
				gotoDetect();
			};
		showtext($("link_str"), "<#QKSet_Internet_Setup_fail_method1#>");
		showtext($("link_reason"), "<#QKSet_Internet_Setup_fail_reason4#>");
	}
	else if(this.flag.indexOf("l2tp_wrong_") >= 0){
		$("link_id").onclick = function(){
				gotoDetect();
			};
		showtext($("link_str"), "<#QKSet_Internet_Setup_fail_method1#>");
		showtext($("link_reason"), "<#QKSet_Internet_Setup_fail_reason5#>");
	}
	else if(this.flag.indexOf("static_wrong_") >= 0){
		$("link_id").onclick = function(){
				gotoDetect();
			};
		showtext($("link_str"), "<#QKSet_Internet_Setup_fail_method1#>");
		showtext($("link_reason"), "<#QKSet_Internet_Setup_fail_reason6#>");
	}
}

function gotoInternet(){
	//set_x_Setting("1", "/qis/QIS_internet_success.htm");
	
	if(navigator.appName.indexOf("Microsoft") >= 0)
		window.open("about:home");
	
	parent.location.href = "/gotoHomePage.htm";
}

function gotoAdvSetting(){
	//set_x_Setting("1", "/qis/QIS_internet_success.htm");
	
	parent.location.href = "/Advanced_WAN_Content.asp"
}

function gotoWireless(){
	parent.set_failed_connection_reason(flag);
	
	with(document.resultForm){
		action = "/qis/QIS_wireless.htm";
		target = "";
		
		$("flag").value = "";
		
		submit();
	}
}

function gotoDetect(){
	with(document.resultForm){
		action = "/QIS_wizard.htm";
		target = "_parent";
		
		$("flag").value = "detect";
		
		submit();
	}
}

function gotoPPPoE(){
	with(document.resultForm){
		action = "/QIS_wizard.htm";
		target = "_parent";
		
		$("flag").value = "pppoe";
		
		submit();
	}
}

function set_x_Setting(set, page){
	with(document.resultForm){
		action = "/start_apply.htm";
		target = "hidden_frame";
		
		current_page.value = page;
		next_page.value = page;
		action_mode.value = " Apply ";
		sid_list.value = "General;";
		$("x_Setting").disabled = false;
		x_Setting.value = set;
		
		$("flag").value = "";
		submit();
	}
}
function addBookmarkForBrowser(sTitle) {
	 sTitle = sTitle+" - "+ reIP;
	 
   if (document.all){
      window.external.addFavorite('http://'+reIP, sTitle);
   }
   else if (window.sidebar && window.sidebar.addPanel){
      window.sidebar.addPanel(sTitle, 'http://'+reIP, "");
   }
   else {
			addBookmarkForBrowser = function() {
				alert("<#Browser_action_not_support_addfavorite#>");
			}
   }
}
</script>
</head>

<body onLoad="QKfinish_load_body();">
<div class="QISmain">
<div class="description_down" id="title_item"><#QKSet_finish_desc#></div>
<br/><br/>
<table id="tblsetting_1" class="QISform" width="400" border=0 align="center" cellpadding="5" cellspacing="0">
	<tr>
		<td>
			<ol>
				<li id="fail_to_connect" style="display:none;">
					<a id="link_id" href="javascript:;"><span id="link_str"></span></a>: <span id="link_reason"></span>
    	  </li>
    	  <li id="succeed_to_connect" style="display:none;">
    	  	<a href="http://support.asus.com" target="_parent"><#QKSet_finish_moveto1#></a><br/>
    	  	<!--span id="no_security_hint" style="display:none;" class="hint_word"><#QKSet_finish_moveto3#></span-->
    	  	<span class="hint_word"><#QKSet_finish_moveto9#></span>
    	  </li>
    	  <li id="li_of_wireless" style="display:none;">
    	  	<a href="javascript:gotoWireless();"><#QKSet_finish_moveto5#></a>: 
    	  	<#QKSet_finish_moveto6#>
    	  </li>
    	  <li style="display:;">
    	  	<!--a href="/Advanced_WAN_Content.asp" target="_parent"><#QKSet_finish_moveto7#></a-->
    	  	<a href="javascript:gotoAdvSetting();"><#QKSet_finish_moveto7#></a>:
    	  	<#QKSet_finish_moveto8#>
				</li>
				<li>
					<a href="javascript:addBookmarkForBrowser('ASUS <#Web_Title#>');"><#Browser_action_addfavorite#></a>: 
					<#Browser_action_addfavorite_hint2#>
				</li>
				<li id="check_isp" style="display:none;">
					<#QKSet_Internet_Setup_fail_reason7#>
				</li>							
			</ol>
		</td>
	</tr>
</table>
</div>

<br>
<iframe name="hidden_frame" id="hidden_frame" width="0" height="0" frameborder="0"></iframe>
<form method="post" name="resultForm" action="">
<input type="hidden" name="current_page" value="">
<input type="hidden" name="next_page" value="">
<input type="hidden" name="action_mode" value="">
<input type="hidden" name="sid_list" value="">
<input type="hidden" name="x_Setting" id="x_Setting" value="" disabled>

<input type="hidden" name="flag" id="flag" value="">
</form>

<div class="QISfoot">
	<input type='button' id="closeButton" value="<#QKSet_finishpre_rebootnow#>" onclick="parent.closeQIS();" class="sbtn" width="70" align="center">
</div>
</body>
